Using device: cuda:0 | Experiment: 260123_12
Running initial validation...
Epoch 1/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4812 (Det: 0.1960, Desc: 0.2852)
Epoch 2/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4629 (Det: 0.1833, Desc: 0.2797)
Epoch 3/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4559 (Det: 0.1820, Desc: 0.2740)
Epoch 4/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4493 (Det: 0.1816, Desc: 0.2677)
Epoch 5/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4407 (Det: 0.1798, Desc: 0.2609)
New Best Mean Error: 312.2784 px (Previous: inf px)
Epoch 6/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4254 (Det: 0.1733, Desc: 0.2521)
Epoch 7/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.4019 (Det: 0.1625, Desc: 0.2393)
Epoch 8/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3865 (Det: 0.1558, Desc: 0.2307)
Epoch 9/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3737 (Det: 0.1514, Desc: 0.2223)
Epoch 10/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3597 (Det: 0.1468, Desc: 0.2128)
Epoch 11/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3482 (Det: 0.1431, Desc: 0.2051)
Epoch 12/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3368 (Det: 0.1390, Desc: 0.1978)
Epoch 13/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3299 (Det: 0.1363, Desc: 0.1937)
Epoch 14/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3242 (Det: 0.1338, Desc: 0.1904)
Epoch 15/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3171 (Det: 0.1324, Desc: 0.1847)
Epoch 16/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3095 (Det: 0.1295, Desc: 0.1800)
Epoch 17/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3056 (Det: 0.1284, Desc: 0.1772)
Epoch 18/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.3023 (Det: 0.1258, Desc: 0.1765)
Epoch 19/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.2939 (Det: 0.1241, Desc: 0.1698)
Epoch 20/500 | Phase 1: Warmup (Desc + GT Det)
Train Total Loss: 0.2908 (Det: 0.1231, Desc: 0.1676)
Epoch 21/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.3154 (Det: 0.1518, Desc: 0.1635)
Epoch 22/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.3139 (Det: 0.1476, Desc: 0.1664)
Epoch 23/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.3108 (Det: 0.1468, Desc: 0.1639)
Epoch 24/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.3012 (Det: 0.1438, Desc: 0.1574)
Epoch 25/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.3013 (Det: 0.1443, Desc: 0.1570)
Epoch 26/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2977 (Det: 0.1436, Desc: 0.1541)
Epoch 27/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2937 (Det: 0.1424, Desc: 0.1513)
Epoch 28/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2934 (Det: 0.1420, Desc: 0.1513)
Epoch 29/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2932 (Det: 0.1407, Desc: 0.1524)
Epoch 30/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2901 (Det: 0.1411, Desc: 0.1490)
New Best Mean Error: 291.5154 px (Previous: 312.2784 px)
Epoch 31/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2855 (Det: 0.1391, Desc: 0.1464)
Epoch 32/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2821 (Det: 0.1384, Desc: 0.1437)
Epoch 33/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2809 (Det: 0.1380, Desc: 0.1430)
Epoch 34/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2786 (Det: 0.1368, Desc: 0.1418)
Epoch 35/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2768 (Det: 0.1368, Desc: 0.1401)
New Best Mean Error: 259.1870 px (Previous: 291.5154 px)
Epoch 36/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2761 (Det: 0.1367, Desc: 0.1394)
Epoch 37/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2754 (Det: 0.1362, Desc: 0.1393)
Epoch 38/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2737 (Det: 0.1354, Desc: 0.1383)
Epoch 39/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2797 (Det: 0.1371, Desc: 0.1425)
Epoch 40/500 | Phase 2: Geo Consistency (Desc + GT Det + Geo Det)
Train Total Loss: 0.2710 (Det: 0.1343, Desc: 0.1367)
Epoch 41/500 | Phase 3: Joint PKE
Train Total Loss: 0.2804 (Det: 0.1492, Desc: 0.1313)
Epoch 42/500 | Phase 3: Joint PKE
Train Total Loss: 0.2807 (Det: 0.1475, Desc: 0.1332)
Epoch 43/500 | Phase 3: Joint PKE
Train Total Loss: 0.2766 (Det: 0.1470, Desc: 0.1296)
Epoch 44/500 | Phase 3: Joint PKE
Train Total Loss: 0.2738 (Det: 0.1448, Desc: 0.1290)
Epoch 45/500 | Phase 3: Joint PKE
Train Total Loss: 0.2789 (Det: 0.1468, Desc: 0.1321)
New Best Mean Error: 258.3846 px (Previous: 259.1870 px)
Epoch 46/500 | Phase 3: Joint PKE
Train Total Loss: 0.2775 (Det: 0.1446, Desc: 0.1328)
Epoch 47/500 | Phase 3: Joint PKE
Train Total Loss: 0.2757 (Det: 0.1454, Desc: 0.1303)
Epoch 48/500 | Phase 3: Joint PKE
Train Total Loss: 0.2741 (Det: 0.1448, Desc: 0.1293)
Epoch 49/500 | Phase 3: Joint PKE
Train Total Loss: 0.2689 (Det: 0.1441, Desc: 0.1248)
Epoch 50/500 | Phase 3: Joint PKE
Train Total Loss: 0.2680 (Det: 0.1432, Desc: 0.1248)
Epoch 51/500 | Phase 3: Joint PKE
Train Total Loss: 0.2659 (Det: 0.1424, Desc: 0.1235)
Epoch 52/500 | Phase 3: Joint PKE
Train Total Loss: 0.2723 (Det: 0.1434, Desc: 0.1289)
Epoch 53/500 | Phase 3: Joint PKE
Train Total Loss: 0.2614 (Det: 0.1421, Desc: 0.1193)
Epoch 54/500 | Phase 3: Joint PKE
Train Total Loss: 0.2618 (Det: 0.1408, Desc: 0.1210)
Epoch 55/500 | Phase 3: Joint PKE
Train Total Loss: 0.2652 (Det: 0.1431, Desc: 0.1221)
New Best Mean Error: 196.3882 px (Previous: 258.3846 px)
Epoch 56/500 | Phase 3: Joint PKE
Train Total Loss: 0.2654 (Det: 0.1418, Desc: 0.1236)
Epoch 57/500 | Phase 3: Joint PKE
Train Total Loss: 0.2641 (Det: 0.1420, Desc: 0.1221)
Epoch 58/500 | Phase 3: Joint PKE
Train Total Loss: 0.2596 (Det: 0.1397, Desc: 0.1199)
Epoch 59/500 | Phase 3: Joint PKE
Train Total Loss: 0.2582 (Det: 0.1406, Desc: 0.1177)
Epoch 60/500 | Phase 3: Joint PKE
Train Total Loss: 0.2590 (Det: 0.1400, Desc: 0.1190)
New Best Mean Error: 190.5175 px (Previous: 196.3882 px)
Epoch 61/500 | Phase 3: Joint PKE
Train Total Loss: 0.2560 (Det: 0.1398, Desc: 0.1161)
Epoch 62/500 | Phase 3: Joint PKE
Train Total Loss: 0.2553 (Det: 0.1390, Desc: 0.1163)
Epoch 63/500 | Phase 3: Joint PKE
Train Total Loss: 0.2531 (Det: 0.1383, Desc: 0.1148)
Epoch 64/500 | Phase 3: Joint PKE
Train Total Loss: 0.2524 (Det: 0.1383, Desc: 0.1141)
Epoch 65/500 | Phase 3: Joint PKE
Train Total Loss: 0.2576 (Det: 0.1389, Desc: 0.1187)
Epoch 66/500 | Phase 3: Joint PKE
Train Total Loss: 0.2509 (Det: 0.1377, Desc: 0.1132)
Epoch 67/500 | Phase 3: Joint PKE
Train Total Loss: 0.2506 (Det: 0.1364, Desc: 0.1142)
Epoch 68/500 | Phase 3: Joint PKE
Train Total Loss: 0.2541 (Det: 0.1377, Desc: 0.1164)
Epoch 69/500 | Phase 3: Joint PKE
Train Total Loss: 0.2547 (Det: 0.1382, Desc: 0.1165)
Epoch 70/500 | Phase 3: Joint PKE
Train Total Loss: 0.2509 (Det: 0.1373, Desc: 0.1136)
Epoch 71/500 | Phase 3: Joint PKE
Train Total Loss: 0.2466 (Det: 0.1362, Desc: 0.1105)
Epoch 72/500 | Phase 3: Joint PKE
Train Total Loss: 0.2507 (Det: 0.1376, Desc: 0.1131)
Epoch 73/500 | Phase 3: Joint PKE
Train Total Loss: 0.2489 (Det: 0.1364, Desc: 0.1125)
Epoch 74/500 | Phase 3: Joint PKE
Train Total Loss: 0.2432 (Det: 0.1350, Desc: 0.1082)
Epoch 75/500 | Phase 3: Joint PKE
Train Total Loss: 0.2464 (Det: 0.1367, Desc: 0.1097)
Epoch 76/500 | Phase 3: Joint PKE
Train Total Loss: 0.2456 (Det: 0.1364, Desc: 0.1091)
Epoch 77/500 | Phase 3: Joint PKE
Train Total Loss: 0.2436 (Det: 0.1350, Desc: 0.1086)
Epoch 78/500 | Phase 3: Joint PKE
Train Total Loss: 0.2474 (Det: 0.1364, Desc: 0.1110)
Epoch 79/500 | Phase 3: Joint PKE
Train Total Loss: 0.2465 (Det: 0.1353, Desc: 0.1112)
Epoch 80/500 | Phase 3: Joint PKE
Train Total Loss: 0.2357 (Det: 0.1324, Desc: 0.1033)
Epoch 81/500 | Phase 3: Joint PKE
Train Total Loss: 0.2398 (Det: 0.1336, Desc: 0.1062)
Epoch 82/500 | Phase 3: Joint PKE
Train Total Loss: 0.2406 (Det: 0.1340, Desc: 0.1066)
Epoch 83/500 | Phase 3: Joint PKE
Train Total Loss: 0.2417 (Det: 0.1345, Desc: 0.1072)
Epoch 84/500 | Phase 3: Joint PKE
Train Total Loss: 0.2384 (Det: 0.1328, Desc: 0.1056)
Epoch 85/500 | Phase 3: Joint PKE
Train Total Loss: 0.2367 (Det: 0.1333, Desc: 0.1035)
Epoch 86/500 | Phase 3: Joint PKE
Train Total Loss: 0.2382 (Det: 0.1335, Desc: 0.1047)
Epoch 87/500 | Phase 3: Joint PKE
Train Total Loss: 0.2329 (Det: 0.1316, Desc: 0.1014)
Epoch 88/500 | Phase 3: Joint PKE
Train Total Loss: 0.2358 (Det: 0.1318, Desc: 0.1040)
Epoch 89/500 | Phase 3: Joint PKE
Train Total Loss: 0.2311 (Det: 0.1309, Desc: 0.1002)
Epoch 90/500 | Phase 3: Joint PKE
Train Total Loss: 0.2353 (Det: 0.1329, Desc: 0.1024)
New Best Mean Error: 171.2518 px (Previous: 190.5175 px)
Epoch 91/500 | Phase 3: Joint PKE
Train Total Loss: 0.2339 (Det: 0.1311, Desc: 0.1029)
Epoch 92/500 | Phase 3: Joint PKE
Train Total Loss: 0.2375 (Det: 0.1320, Desc: 0.1055)
Epoch 93/500 | Phase 3: Joint PKE
Train Total Loss: 0.2404 (Det: 0.1331, Desc: 0.1074)
Epoch 94/500 | Phase 3: Joint PKE
Train Total Loss: 0.2341 (Det: 0.1313, Desc: 0.1028)
Epoch 95/500 | Phase 3: Joint PKE
Train Total Loss: 0.2308 (Det: 0.1299, Desc: 0.1009)
Epoch 96/500 | Phase 3: Joint PKE
Train Total Loss: 0.2336 (Det: 0.1307, Desc: 0.1029)
Epoch 97/500 | Phase 3: Joint PKE
Train Total Loss: 0.2299 (Det: 0.1306, Desc: 0.0993)
Epoch 98/500 | Phase 3: Joint PKE
Train Total Loss: 0.2280 (Det: 0.1297, Desc: 0.0983)
Epoch 99/500 | Phase 3: Joint PKE
Train Total Loss: 0.2318 (Det: 0.1308, Desc: 0.1011)
Epoch 100/500 | Phase 3: Joint PKE
Train Total Loss: 0.2312 (Det: 0.1310, Desc: 0.1002)
[Early Stopping] Validation Mean Error improved to 240.8401 px. Reset patience counter.
Epoch 101/500 | Phase 3: Joint PKE
Train Total Loss: 0.2278 (Det: 0.1288, Desc: 0.0990)
Epoch 102/500 | Phase 3: Joint PKE
Train Total Loss: 0.2280 (Det: 0.1301, Desc: 0.0978)
Epoch 103/500 | Phase 3: Joint PKE
Train Total Loss: 0.2319 (Det: 0.1298, Desc: 0.1021)
Epoch 104/500 | Phase 3: Joint PKE
Train Total Loss: 0.2263 (Det: 0.1297, Desc: 0.0967)
Epoch 105/500 | Phase 3: Joint PKE
Train Total Loss: 0.2291 (Det: 0.1303, Desc: 0.0988)
[Early Stopping] Validation Mean Error improved to 217.9090 px. Reset patience counter.
Epoch 106/500 | Phase 3: Joint PKE
Train Total Loss: 0.2310 (Det: 0.1290, Desc: 0.1020)
Epoch 107/500 | Phase 3: Joint PKE
Train Total Loss: 0.2252 (Det: 0.1288, Desc: 0.0964)
Epoch 108/500 | Phase 3: Joint PKE
Train Total Loss: 0.2269 (Det: 0.1289, Desc: 0.0979)
Epoch 109/500 | Phase 3: Joint PKE
Train Total Loss: 0.2245 (Det: 0.1283, Desc: 0.0962)
Epoch 110/500 | Phase 3: Joint PKE
Train Total Loss: 0.2216 (Det: 0.1274, Desc: 0.0941)
New Best Mean Error: 155.9179 px (Previous: 171.2518 px)
[Early Stopping] Validation Mean Error improved to 155.9179 px. Reset patience counter.
Epoch 111/500 | Phase 3: Joint PKE
Train Total Loss: 0.2264 (Det: 0.1296, Desc: 0.0968)
Epoch 112/500 | Phase 3: Joint PKE
Train Total Loss: 0.2263 (Det: 0.1290, Desc: 0.0973)
Epoch 113/500 | Phase 3: Joint PKE
Train Total Loss: 0.2236 (Det: 0.1281, Desc: 0.0955)
Epoch 114/500 | Phase 3: Joint PKE
Train Total Loss: 0.2260 (Det: 0.1284, Desc: 0.0976)
Epoch 115/500 | Phase 3: Joint PKE
Train Total Loss: 0.2244 (Det: 0.1275, Desc: 0.0970)
[Early Stopping] Validation Mean Error did not improve. Patience: 1/5
Epoch 116/500 | Phase 3: Joint PKE
Train Total Loss: 0.2211 (Det: 0.1268, Desc: 0.0944)
Epoch 117/500 | Phase 3: Joint PKE
Train Total Loss: 0.2226 (Det: 0.1274, Desc: 0.0952)
Epoch 118/500 | Phase 3: Joint PKE
Train Total Loss: 0.2222 (Det: 0.1278, Desc: 0.0944)
Epoch 119/500 | Phase 3: Joint PKE
Train Total Loss: 0.2269 (Det: 0.1290, Desc: 0.0979)
Epoch 120/500 | Phase 3: Joint PKE
Train Total Loss: 0.2256 (Det: 0.1276, Desc: 0.0979)
[Early Stopping] Validation Mean Error did not improve. Patience: 2/5
Epoch 121/500 | Phase 3: Joint PKE
Train Total Loss: 0.2202 (Det: 0.1277, Desc: 0.0925)
Epoch 122/500 | Phase 3: Joint PKE
Train Total Loss: 0.2200 (Det: 0.1274, Desc: 0.0926)
Epoch 123/500 | Phase 3: Joint PKE
Train Total Loss: 0.2217 (Det: 0.1267, Desc: 0.0950)
Epoch 124/500 | Phase 3: Joint PKE
Train Total Loss: 0.2178 (Det: 0.1252, Desc: 0.0926)
Epoch 125/500 | Phase 3: Joint PKE
Train Total Loss: 0.2210 (Det: 0.1269, Desc: 0.0941)
[Early Stopping] Validation Mean Error did not improve. Patience: 3/5
Epoch 126/500 | Phase 3: Joint PKE
Train Total Loss: 0.2186 (Det: 0.1263, Desc: 0.0922)
Epoch 127/500 | Phase 3: Joint PKE
Train Total Loss: 0.2232 (Det: 0.1276, Desc: 0.0956)
Epoch 128/500 | Phase 3: Joint PKE
Train Total Loss: 0.2170 (Det: 0.1260, Desc: 0.0910)
Epoch 129/500 | Phase 3: Joint PKE
Train Total Loss: 0.2236 (Det: 0.1277, Desc: 0.0959)
Epoch 130/500 | Phase 3: Joint PKE
Train Total Loss: 0.2162 (Det: 0.1254, Desc: 0.0908)
[Early Stopping] Validation Mean Error did not improve. Patience: 4/5
Epoch 131/500 | Phase 3: Joint PKE
Train Total Loss: 0.2161 (Det: 0.1249, Desc: 0.0912)
Epoch 132/500 | Phase 3: Joint PKE
Train Total Loss: 0.2192 (Det: 0.1253, Desc: 0.0939)
Epoch 133/500 | Phase 3: Joint PKE
Train Total Loss: 0.2157 (Det: 0.1250, Desc: 0.0906)
Epoch 134/500 | Phase 3: Joint PKE
Train Total Loss: 0.2182 (Det: 0.1253, Desc: 0.0929)
Epoch 135/500 | Phase 3: Joint PKE
Train Total Loss: 0.2173 (Det: 0.1249, Desc: 0.0924)
[Early Stopping] Validation Mean Error did not improve. Patience: 5/5
Early stopping triggered at epoch 135. Best validation Mean Error: 155.9179 px
